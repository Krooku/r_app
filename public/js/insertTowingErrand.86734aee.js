(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["insertTowingErrand"],{"0529":function(t,e,n){},"0aa0":function(t,e,n){"use strict";var a=n("ec51"),r=n.n(a);r.a},"448b":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form"},[0==t.type?n("input",{attrs:{spellcheck:"false",type:"text",name:"name",autocomplete:"new password",minlength:"1",maxlength:t.maxlength,required:t.required,disabled:!t.active},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}):1==t.type?n("input",{attrs:{type:"password",name:"name",autocomplete:"off",maxlength:t.maxlength,required:t.required,disabled:!t.active},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}):2==t.type?n("input",{attrs:{type:"email",name:"name",autocomplete:"off",maxlength:t.maxlength,required:t.required,disabled:!t.active},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}):n("input",{attrs:{type:"number",name:"name",autocomplete:"off",min:t.min,max:t.max,required:t.required,disabled:!t.active},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}),n("label",{staticClass:"label-name",attrs:{for:"name"}},[n("span",{ref:"label",staticClass:"content-name"},[t._v(" "+t._s(t.labelText)+" ")])])])},r=[],i={props:{type:{type:Number,default:0},value:{type:[String,Number],default:""},labelText:{type:String,default:"test"},maxlength:{type:Number,default:32},min:{type:Number,default:0},max:{type:Number,default:1e4},isActive:{type:Boolean,default:!0},required:{type:Boolean,default:!0}},data:function(){return{active:this.isActive,val:this.value}},mounted:function(){this.active||this.$refs.label.classList.add("unactive")},methods:{setActive:function(t){var e=this;this.active!==t&&(this.active=t,this.active?(this.$refs.label.classList.remove("unactive"),this.$refs.label.classList.add("unactive-leave"),setTimeout((function(){e.$refs.label.classList.remove("unactive-leave")}),800)):(this.$refs.label.classList.add("unactive"),this.val="",this.$emit("input",this.val)))}}},s=i,o=(n("0aa0"),n("2877")),l=Object(o["a"])(s,a,r,!1,null,null,null);e["a"]=l.exports},"652c":function(t,e,n){},a217:function(t,e,n){},a6f9:function(t,e,n){"use strict";var a=n("efbe"),r=n.n(a);r.a},a7bf:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("div",{staticClass:"flex_box container"},[t.loaded?t._e():n("div",{staticClass:"spinner"}),n("transition",{attrs:{name:"fade",mode:"out-in"}},[t.errandId&&t.loaded&&4!==t.stage&&t.endAnim?n("div",{staticClass:"flex_box stages"},[n("div",{staticClass:"circle",class:{"circle--active":1==t.stage,"circle--inactive":1!=t.stage},on:{click:function(e){return t.navStages(1)}}}),n("div",{staticClass:"circle",class:{"circle--active":2==t.stage,"circle--inactive":2!=t.stage},on:{click:function(e){return t.navStages(2)}}}),n("div",{staticClass:"circle",class:{"circle--active":3==t.stage,"circle--inactive":3!=t.stage},on:{click:function(e){return t.navStages(3)}}})]):t._e()]),t.loaded?n("transition",{attrs:{name:"slide",mode:"out-in"}},[0===t.stage?n("stage-1",{key:"stage1",on:{nextStage:t.nextStage}}):1===t.stage&&t.errandId?n("stage-2",{key:"stage2",ref:"stage2",attrs:{"errand-id":t.errandId,errand:t.errand},on:{nextStage:t.nextStage}}):2===t.stage&&t.errandId?n("stage-3",{key:"stage3",ref:"stage3",attrs:{"errand-id":t.errandId,errand:t.errand},on:{nextStage:t.nextStage}}):3===t.stage&&t.errandId?n("stage-4",{key:"stage4",ref:"stage4",attrs:{"errand-id":t.errandId,errand:t.errand},on:{nextStage:t.nextStage}}):n("div",{staticClass:"flex_box column"},[n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Wróć"},on:{click:function(e){t.stage=3,t.endAnimation()}}},[n("span",[t._v("Wróć")])]),n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Zakończ zlecenie"},on:{click:function(e){return t.finishErrand("Zrealizowane")}}},[n("span",[t._v("Zakończ zlecenie")])]),n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Anuluj zlecenie"},on:{click:function(e){return t.finishErrand("Anulowane")}}},[n("span",[t._v("Anuluj zlecenie")])])])],1):t._e()],1):t._e()},r=[],i=n("a34a"),s=n.n(i),o=n("d722"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"flex_box stage",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.nextStage(e)}}},[n("input-label",{attrs:{type:0,maxlength:64,"label-text":"Numer zlecenia"},model:{value:t.errandNumber,callback:function(e){t.errandNumber=e},expression:"errandNumber"}}),n("input-label",{attrs:{type:0,maxlength:10,"label-text":"Numer rej. auta klienta"},model:{value:t.carNumber,callback:function(e){t.carNumber=e},expression:"carNumber"}}),n("input-label",{attrs:{type:0,maxlength:10,"label-text":"Numer rej. holownika"},model:{value:t.tugNumber,callback:function(e){t.tugNumber=e},expression:"tugNumber"}}),t._m(0)],1)},c=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"btn btn--winona",attrs:{"data-text":"Wyślij",type:"submit"}},[n("span",[t._v(" Wyślij ")])])}],u=n("448b");function d(t,e,n,a,r,i,s){try{var o=t[i](s),l=o.value}catch(c){return void n(c)}o.done?e(l):Promise.resolve(l).then(a,r)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function s(t){d(i,a,r,s,o,"next",t)}function o(t){d(i,a,r,s,o,"throw",t)}s(void 0)}))}}var f={components:{InputLabel:u["a"]},data:function(){return{errandNumber:null,carNumber:null,tugNumber:null,errand:null,error:null}},methods:{nextStage:function(){var t=h(s.a.mark((function t(){var e;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].insertTowingErrand({errandNumber:this.errandNumber,carNumber:this.carNumber,tugNumber:this.tugNumber});case 2:if(e=t.sent,200===e.status){t.next=6;break}return console.log(e.data.message),t.abrupt("return",this.error=e.data.message);case 6:this.errand=e.data,this.$emit("nextStage",this.errand);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},p=f,v=n("2877"),m=Object(v["a"])(p,l,c,!1,null,null,null),g=m.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{staticClass:"flex_box stage",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.nextStage(e)}}},[t.loaded?t._e():n("div",{staticClass:"spinner"}),n("input-label",{attrs:{type:2,"label-text":"Dojazd(KM)"},model:{value:t.errandObj.kilometers.drive,callback:function(e){t.$set(t.errandObj.kilometers,"drive",e)},expression:"errandObj.kilometers.drive"}}),n("input-label",{attrs:{type:2,"label-text":"DMC"},model:{value:t.errandObj.DMC,callback:function(e){t.$set(t.errandObj,"DMC",e)},expression:"errandObj.DMC"}}),n("input-label",{attrs:{type:0,maxlength:64,"label-text":"Miejsce zdarzenia"},model:{value:t.errandObj.incidentPlace,callback:function(e){t.$set(t.errandObj,"incidentPlace",e)},expression:"errandObj.incidentPlace"}}),n("div",{staticClass:"date-box"},[n("span",{staticClass:"content-name"},[t._v(" Data dojazdu ")]),n("date-picker",{staticClass:"date",attrs:{"value-type":"format",placeholder:t.fullDate.date,required:""},model:{value:t.fullDate.date,callback:function(e){t.$set(t.fullDate,"date",e)},expression:"fullDate.date"}})],1),n("div",{staticClass:"date-box"},[n("span",{staticClass:"content-name"},[t._v(" Godzina dojazdu ")]),n("date-picker",{staticClass:"date",attrs:{"minute-step":1,format:"HH:mm","value-type":"format",type:"time",placeholder:t.fullDate.time},model:{value:t.fullDate.time,callback:function(e){t.$set(t.fullDate,"time",e)},expression:"fullDate.time"}})],1),n("div",{staticClass:"transport_container",class:{"transport_container--active":t.isTransport,"":!t.isTransport}},[n("p",[t._v(" Czy odbędzie się transport osób? ")]),n("div",{staticClass:"flex_box answer"},[n("div",{staticClass:"btn answer_btn",class:{"answer_btn--active":t.isTransport,"":!t.isTransport},on:{click:function(e){return t.showTransport(!0)}}},[t._v(" TAK ")]),n("div",{staticClass:"btn answer_btn",class:{"answer_btn--active":!t.isTransport,"":t.isTransport},on:{click:function(e){return t.showTransport(!1)}}},[t._v(" NIE ")])]),n("drop-down",[t.isTransport?n("div",[n("input-label",{ref:"quantity",attrs:{type:2,"label-text":"Ilość transportowanych osób"},model:{value:t.errandObj.transport.quantity,callback:function(e){t.$set(t.errandObj.transport,"quantity",e)},expression:"errandObj.transport.quantity"}}),t.errandObj.transport.type||""===t.errandObj.transport.type?n("check-box",{ref:"transport_type",attrs:{"text-label":"Sposób transpotu osób",options:["Kabina","Osobowy","Oba"]},model:{value:t.errandObj.transport.type,callback:function(e){t.$set(t.errandObj.transport,"type",e)},expression:"errandObj.transport.type"}}):t._e()],1):t._e()])],1),n("input-label",{attrs:{type:0,maxlength:128,"label-text":"Uwagi"},model:{value:t.errandObj.description,callback:function(e){t.$set(t.errandObj,"description",e)},expression:"errandObj.description"}}),n("p",{staticClass:"clickable",on:{click:function(e){t.takePhoto=!t.takePhoto}}},[t._v(" Zrób zdjęcia "),n("i",{staticClass:"icon fas fa-camera"}),t.photos.length>0?n("span",[t._v("Wysyłanie "+t._s(t.compliteSend)+" z "+t._s(t.photos.length)+" ")]):t._e()]),t.takePhoto?n("Camera",{on:{take:t.takePhotoF,close:function(e){return t.sendPhotos()}}}):t._e(),n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Dalej(Holowanie)"},on:{click:t.nextStage}},[n("span",[t._v("Dalej(Holowanie)")])])],1)])},j=[],y=n("ec45"),x=(n("411c"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"camera"},[n("video",{staticClass:"feed",attrs:{autoplay:"",playsinline:""}}),n("i",{staticClass:"icon fas fa-window-close",on:{click:function(e){return t.$emit("close")}}}),n("div",{attrs:{id:"snap"},on:{click:t.takepicture}}),n("canvas",{staticClass:"hidden",attrs:{id:"canvas"}}),n("div",{class:{flash:t.isFlash,hidden:!t.isFlash}}),t.visiblePhoto?n("div",{staticClass:"taken-photo"},[n("img",{attrs:{id:"photo",src:t.data,alt:"Hmm, cos nie tak"}}),n("div",{staticClass:"btn1",on:{click:function(e){return t.save(!1)}}},[t._v(" Zrób nowe ")]),n("div",{staticClass:"btn2",on:{click:function(e){return t.save(!0)}}},[t._v(" Zapisz ")])]):t._e()])}),O=[],w={name:"Camera",data:function(){return{front:!1,videoPlayer:null,canvas:null,photo:null,snapBtn:null,width:window.innerWidth,height:window.innerHeight,streaming:!1,isFlash:!1,data:"",visiblePhoto:!1}},beforeMount:function(){this.videoPlayer=document.querySelector("video"),this.canvas=document.getElementById("canvas"),this.photo=document.getElementById("photo"),this.startbutton=document.getElementById("snap"),this.width=window.innerWidth,this.height=window.innerHeight,this.init()},created:function(){},methods:{getConstraints:function(t,e){var n={facingMode:{exact:"environment"},width:{min:t,ideal:t,max:t},height:{min:e,ideal:e,max:e},frameRate:{min:5,max:8}};return n},init:function(){var t=this;if("mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices){navigator.mediaDevices.getUserMedia({video:this.getConstraints(1600,1200)}).then((function(t){var e=document.querySelector("video");e.srcObject=t,e.play()})).catch((function(e){console.log(e),t.$emit("close")}));var e=document.querySelector("video");e&&e.addEventListener("canplay",(function(e){t.streaming||(console.log(t.width+" "+t.height),t.streaming=!0)}),!1)}else alert("cannot get Media Devices"),this.$emit("close")},save:function(t){this.visiblePhoto=!1,t&&this.$emit("take",this.data)},takepicture:function(){var t=this,e=document.getElementById("canvas"),n=e.getContext("2d");if(this.width&&this.height){e.width=1600,e.height=1200;var a=document.querySelector("video");n.drawImage(a,0,0,1600,1200),this.data=e.toDataURL("image/jpeg",1),this.isFlash=!0,setTimeout((function(){t.isFlash=!1}),500),this.visiblePhoto=!0}else alert("clearphoto")}}},k=w,D=(n("e902"),Object(v["a"])(k,x,O,!1,null,null,null)),_=D.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",[t._v(" "+t._s(t.textLabel)+" ")]),n("div",{ref:"container",staticClass:"flex_box options"},t._l(t.options,(function(e,a){return n("div",{key:e,ref:"options",refInFor:!0,staticClass:"option",on:{click:function(n){return t.setValue(e,a)}}},[t._v(" "+t._s(e)+" ")])})),0)])},S=[],$={props:{value:{type:String,required:!0},textLabel:{type:String,default:""},options:{type:Array,required:!0},isActive:{type:Boolean,default:!0}},data:function(){return{selected:this.value,active:this.isActive}},mounted:function(){this.isActive||this.$refs.container.classList.add("unactive"),this.$refs.options.forEach((function(t){t.style.margin="0 0 0 ".concat(t.clientHeight,"px"),t.style.width="".concat(t.clientHeight,"px")})),this.value&&""!==this.value&&(this.setActive(!0),this.setValue(this.value,this.options.indexOf(this.value)))},methods:{handleValue:function(){this.$emit("input",this.selected)},setValue:function(t,e){this.active&&(Object.values(this.$refs.options[e].classList).find((function(t){return"option-active"===t}))?(this.$refs.options[e].classList.remove("option-active"),this.selected=""):(this.$refs.options.forEach((function(t){t.classList.remove("option-active")})),this.$refs.options[e].classList.add("option-active"),this.selected=t),this.handleValue())},setActive:function(t){var e=this;this.active!==t&&(this.active=t,this.active?(this.$refs.container.classList.remove("unactive"),this.$refs.container.classList.add("unactive-leave"),setTimeout((function(){e.$refs.container.classList.remove("unactive-leave")}),800)):(this.$refs.container.classList.add("unactive"),this.$refs.options.forEach((function(t){t.classList.remove("option-active")})),this.selected="",this.handleValue()))}}},N=$,P=(n("f322"),Object(v["a"])(N,C,S,!1,null,"7d392dc9",null)),E=P.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{"enter-active-class":"enter-active","leave-active-class":"leave-active"},on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[t._t("default")],2)},q=[],T={methods:{beforeEnter:function(t){requestAnimationFrame((function(){t.style.height||(t.style.height="0"),t.style.display=null}))},enter:function(t){requestAnimationFrame((function(){requestAnimationFrame((function(){t.style.height="".concat(t.scrollHeight,"px")}))}))},afterEnter:function(t){t.style.height=null},beforeLeave:function(t){requestAnimationFrame((function(){t.style.height||(t.style.height="".concat(t.offsetHeight,"px"))}))},leave:function(t){requestAnimationFrame((function(){requestAnimationFrame((function(){t.style.height="0"}))}))},afterLeave:function(t){t.style.height=null}}},M=T,H=(n("f0ff"),Object(v["a"])(M,I,q,!1,null,"61380581",null)),A=H.exports;function L(t,e,n,a,r,i,s){try{var o=t[i](s),l=o.value}catch(c){return void n(c)}o.done?e(l):Promise.resolve(l).then(a,r)}function z(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function s(t){L(i,a,r,s,o,"next",t)}function o(t){L(i,a,r,s,o,"throw",t)}s(void 0)}))}}var J={components:{InputLabel:u["a"],DatePicker:y["a"],Camera:_,CheckBox:E,DropDown:A},props:{errandId:{type:String,required:!0},errand:{type:Object,required:!0}},data:function(){return{startErrandObject:{},errandObj:{kilometers:{drive:null},journey:{drive:null},transport:{quantity:null,type:null}},kilometers:null,fullDate:{date:this.formatDate(),time:this.formatTime()},DMC:null,incidentPlace:null,photos:[],isTransport:!1,transport:{quantity:null,type:""},description:null,takePhoto:!1,loaded:!0,error:null,properties:["DMC","kilometers","incidentPlace","photos","journey","transport","description"],compliteSend:0}},mounted:function(){if(this.errand&&(this.errandObj=Object.assign(this.errandObj,this.errand),null===this.errandObj.transport&&(this.errandObj.transport={quantity:null,type:""}),null===this.errandObj.transport.type&&(this.errandObj.transport.type=""),this.errandObj.transport.quantity&&(this.isTransport=!0),this.errandObj.journey.drive)){var t=new Date(this.errandObj.journey.drive);this.errandObj.journey.drive instanceof Date?this.fullDate.date=this.formatDate(0,t):this.fullDate.date=this.errandObj.journey.drive,t.getMinutes()<10?this.fullDate.time="".concat(t.getHours(),":0").concat(t.getMinutes()):this.fullDate.time="".concat(t.getHours(),":").concat(t.getMinutes())}var e=JSON.stringify(this.errandObj);this.startErrandObject=JSON.parse(e)},methods:{sendPhotos:function(){var t=this;this.takePhoto=!1,this.photos.forEach(function(){var e=z(s.a.mark((function e(n){var a,r,i;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=performance.now(),e.next=3,o["a"].addImage({errandId:t.errandId,image:n});case 3:if(r=e.sent,200===r.status){e.next=6;break}return e.abrupt("return",console.log(r.data.error));case 6:i=performance.now(),t.compliteSend++,console.log(i-a),console.log(r.data);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},getChanges:function(t,e){var n,a=this;if(JSON.stringify(t)===JSON.stringify(e))return!1;for(var r in n=[],Object.keys(t).length,Object.keys(e).length,e)JSON.stringify(t[r])!==JSON.stringify(e[r])&&n.push(r);return console.log(n),n.find((function(t){return a.properties.find((function(e){return t===e}))}))},showTransport:function(t){this.isTransport=t,this.$refs.transport_type},nextStage:function(){var t=z(s.a.mark((function t(){var e,n,a,r,i,l=this,c=arguments;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=!(c.length>0&&void 0!==c[0])||c[0],this.compliteSend===this.photos.length){t.next=3;break}return t.abrupt("return");case 3:if(n=this.fullDate.time.split(":"),a=new Date(this.fullDate.date),a.setHours(n[0]),a.setMinutes(n[1]),r=this.errandObj.journey.drive,this.errandObj.journey.drive=a,this.getChanges(this.startErrandObject,this.errandObj)){t.next=15;break}return this.errandObj.journey.drive=r,this.$emit("nextStage",this.errandObj),t.abrupt("return");case 15:this.errandObj.journey.drive=r;case 16:return null!==this.errandObj.transport.quantity&&(i=this.errandObj.transport),this.loaded=!1,console.log(this.errandObj),t.next=21,o["a"].updateTowingErrandDrive({errandId:this.errandId,kilometers:this.errandObj.kilometers.drive,date:a,DMC:this.errandObj.DMC,incidentPlace:this.errandObj.incidentPlace,transport:i,description:this.errandObj.description}).then((function(t){if(200!==t.status)return console.log(t.data.message),l.error=t.data.message;l.loaded=!0,l.$emit("nextStage",t.data,e)})).catch((function(t){if(console.log(t),200!==t.status)return console.log(t.data.message),l.error=t.data.message}));case 21:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),takePhotoF:function(t){this.photos.push(t)},formatDate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;e.setDate(e.getDate()+t);var n=""+(e.getMonth()+1),a=""+e.getDate(),r=e.getFullYear();return n.length<2&&(n="0".concat(n)),a.length<2&&(a="0".concat(a)),[r,n,a].join("-")},formatTime:function(){var t=new Date;t.setDate(t.getDate());var e="",n=t.getHours(),a=t.getMinutes();return e+=n<10?"0".concat(n,":"):"".concat(n,":"),e+=a<10?"0".concat(a):a,e}}},F=J,W=Object(v["a"])(F,b,j,!1,null,null,null),B=W.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"flex_box stage",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.nextStage(e)}}},[t.loaded?t._e():n("div",{staticClass:"spinner"}),n("input-label",{attrs:{type:2,"label-text":"Holowanie(KM)"},model:{value:t.errandObj.kilometers.towing,callback:function(e){t.$set(t.errandObj.kilometers,"towing",e)},expression:"errandObj.kilometers.towing"}}),n("input-label",{attrs:{type:0,maxlength:64,"label-text":"Docelowe miejsce holowania"},model:{value:t.errandObj.destinationPlace,callback:function(e){t.$set(t.errandObj,"destinationPlace",e)},expression:"errandObj.destinationPlace"}}),n("div",{staticClass:"date-box"},[n("span",{staticClass:"content-name"},[t._v(" Data holowania ")]),n("date-picker",{staticClass:"date",attrs:{"value-type":"format",placeholder:t.fullDate.date,required:""},model:{value:t.fullDate.date,callback:function(e){t.$set(t.fullDate,"date",e)},expression:"fullDate.date"}})],1),n("div",{staticClass:"date-box"},[n("span",{staticClass:"content-name"},[t._v(" Godzina holowania ")]),n("date-picker",{staticClass:"date",attrs:{"minute-step":1,format:"HH:mm","value-type":"format",type:"time",placeholder:t.fullDate.time},model:{value:t.fullDate.time,callback:function(e){t.$set(t.fullDate,"time",e)},expression:"fullDate.time"}})],1),n("select",{directives:[{name:"model",rawName:"v-model",value:t.errandObj.handed,expression:"errandObj.handed"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.errandObj,"handed",e.target.multiple?n:n[0])}}},[n("option",[t._v("serwis ASO")]),n("option",[t._v("inny warsztat")]),n("option",[t._v("dom klienta")]),n("option",[t._v("inne")])]),n("input-label",{attrs:{type:0,maxlength:128,"label-text":"Uwagi"},model:{value:t.errandObj.description,callback:function(e){t.$set(t.errandObj,"description",e)},expression:"errandObj.description"}}),n("div",{staticClass:"flex_box answer"},[n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Wróc(Dojazd)"},on:{click:function(e){return t.nextStage(!0,!1)}}},[n("span",[t._v("Wróc(Dojazd)")])]),n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Dalej(Powrót)"},on:{click:function(e){return t.nextStage()}}},[n("span",[t._v("Dalej(Powrót)")])])])],1)},V=[];function Z(t,e,n,a,r,i,s){try{var o=t[i](s),l=o.value}catch(c){return void n(c)}o.done?e(l):Promise.resolve(l).then(a,r)}function K(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function s(t){Z(i,a,r,s,o,"next",t)}function o(t){Z(i,a,r,s,o,"throw",t)}s(void 0)}))}}var R={components:{InputLabel:u["a"],DatePicker:y["a"]},props:{errandId:{type:String,required:!0},errand:{type:Object,required:!0}},data:function(){return{startErrandObject:{},errandObj:{kilometers:{towing:null},journey:{towing:null}},kilometers:null,fullDate:{date:this.formatDate(),time:this.formatTime()},destinationPlace:null,description:null,handed:"inne",loaded:!0,error:null,properties:["kilometers","destinationPlace","journey","handed","description"]}},mounted:function(){if(this.errand&&(this.errandObj=Object.assign(this.errandObj,this.errand),this.errandObj.journey.towing)){var t=new Date(this.errandObj.journey.towing);this.errandObj.journey.towing instanceof Date?this.fullDate.date=this.formatDate(0,t):this.fullDate.date=this.errandObj.journey.towing,t.getMinutes()<10?this.fullDate.time="".concat(t.getHours(),":0").concat(t.getMinutes()):this.fullDate.time="".concat(t.getHours(),":").concat(t.getMinutes())}var e=JSON.stringify(this.errandObj);this.startErrandObject=JSON.parse(e)},methods:{getChanges:function(t,e){var n,a=this;if(JSON.stringify(t)===JSON.stringify(e))return!1;for(var r in n=[],Object.keys(t).length,Object.keys(e).length,e)JSON.stringify(t[r])!==JSON.stringify(e[r])&&n.push(r);return console.log(n),n.find((function(t){return a.properties.find((function(e){return t===e}))}))},nextStage:function(){var t=K(s.a.mark((function t(){var e,n,a,r,i,l=this,c=arguments;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=!(c.length>0&&void 0!==c[0])||c[0],n=!(c.length>1&&void 0!==c[1])||c[1],a=this.fullDate.time.split(":"),r=new Date(this.fullDate.date),r.setHours(a[0]),r.setMinutes(a[1]),i=this.errandObj.journey.towing,this.errandObj.journey.towing=r,this.getChanges(this.startErrandObject,this.errandObj)){t.next=14;break}return this.errandObj.journey.towing=i,this.$emit("nextStage",this.errandObj,e,n),t.abrupt("return");case 14:this.errandObj.journey.towing=i;case 15:return this.loaded=!1,t.next=18,o["a"].updateTowingErrandTowing({errandId:this.errandId,kilometers:this.errandObj.kilometers.towing,date:r,destinationPlace:this.errandObj.destinationPlace,handed:this.errandObj.handed,description:this.errandObj.description}).then((function(t){if(200!==t.status)return console.log(t.data.message),l.error=t.data.message;l.loaded=!0,l.$emit("nextStage",t.data,e,n)})).catch((function(t){if(console.log(t),200!==t.status)return console.log(t.data.message),l.error=t.data.message}));case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),formatDate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;e.setDate(e.getDate()+t);var n=""+(e.getMonth()+1),a=""+e.getDate(),r=e.getFullYear();return n.length<2&&(n="0".concat(n)),a.length<2&&(a="0".concat(a)),[r,n,a].join("-")},formatTime:function(){var t=new Date;t.setDate(t.getDate());var e="",n=t.getHours(),a=t.getMinutes();return e+=n<10?"0".concat(n,":"):"".concat(n,":"),e+=a<10?"0".concat(a):a,e}}},G=R,Y=Object(v["a"])(G,U,V,!1,null,null,null),Q=Y.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"flex_box stage",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.nextStage(e)}}},[t.loaded?t._e():n("div",{staticClass:"spinner"}),n("input-label",{attrs:{type:2,"label-text":"Powrót(KM)"},model:{value:t.errandObj.kilometers.return,callback:function(e){t.$set(t.errandObj.kilometers,"return",e)},expression:"errandObj.kilometers.return"}}),n("input-label",{attrs:{type:2,"label-text":"Dopłata"},model:{value:t.errandObj.surcharge,callback:function(e){t.$set(t.errandObj,"surcharge",e)},expression:"errandObj.surcharge"}}),n("div",{staticClass:"date-box"},[n("span",{staticClass:"content-name"},[t._v(" Data Powrotu ")]),n("date-picker",{staticClass:"date",attrs:{"value-type":"format",placeholder:t.fullDate.date,required:""},model:{value:t.fullDate.date,callback:function(e){t.$set(t.fullDate,"date",e)},expression:"fullDate.date"}})],1),n("div",{staticClass:"date-box"},[n("span",{staticClass:"content-name"},[t._v(" Godzina Powrotu ")]),n("date-picker",{staticClass:"date",attrs:{"minute-step":1,format:"HH:mm","value-type":"format",type:"time",placeholder:t.fullDate.time},model:{value:t.fullDate.time,callback:function(e){t.$set(t.fullDate,"time",e)},expression:"fullDate.time"}})],1),n("input-label",{attrs:{type:0,maxlength:128,"label-text":"Uwagi"},model:{value:t.errandObj.description,callback:function(e){t.$set(t.errandObj,"description",e)},expression:"errandObj.description"}}),n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Wróc(Holowanie)"},on:{click:function(e){return t.nextStage(!0,!1)}}},[n("span",[t._v("Wróc(Holowanie)")])]),n("div",{staticClass:"btn btn--winona",attrs:{"data-text":"Do weryfikacji"},on:{click:function(e){return t.nextStage()}}},[n("span",[t._v("Do weryfikacji")])])],1)},tt=[];function et(t,e,n,a,r,i,s){try{var o=t[i](s),l=o.value}catch(c){return void n(c)}o.done?e(l):Promise.resolve(l).then(a,r)}function nt(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function s(t){et(i,a,r,s,o,"next",t)}function o(t){et(i,a,r,s,o,"throw",t)}s(void 0)}))}}var at={components:{InputLabel:u["a"],DatePicker:y["a"]},props:{errandId:{type:String,required:!0},errand:{type:Object,required:!0}},data:function(){return{startErrandObject:{},errandObj:{kilometers:{return:null},journey:{return:null}},kilometers:null,fullDate:{date:this.formatDate(),time:this.formatTime()},surcharge:null,description:null,loaded:!0,error:null,properties:["kilometers","journey","surcharge","description"]}},mounted:function(){if(this.errand&&(this.errandObj=Object.assign(this.errandObj,this.errand),this.errandObj.journey.return)){var t=new Date(this.errandObj.journey.return);this.errandObj.journey.return instanceof Date?this.fullDate.date=this.formatDate(0,t):this.fullDate.date=this.errandObj.journey.return,t.getMinutes()<10?this.fullDate.time="".concat(t.getHours(),":0").concat(t.getMinutes()):this.fullDate.time="".concat(t.getHours(),":").concat(t.getMinutes())}var e=JSON.stringify(this.errandObj);this.startErrandObject=JSON.parse(e)},methods:{getChanges:function(t,e){var n,a=this;if(JSON.stringify(t)===JSON.stringify(e))return!1;for(var r in n=[],Object.keys(t).length,Object.keys(e).length,console.log(JSON.stringify(t["kilometers"])),console.log(JSON.stringify(e["kilometers"])),e)JSON.stringify(t[r])!==JSON.stringify(e[r])&&n.push(r);return n.find((function(t){return a.properties.find((function(e){return t===e}))}))},nextStage:function(){var t=nt(s.a.mark((function t(){var e,n,a,r,i,l=this,c=arguments;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=!(c.length>0&&void 0!==c[0])||c[0],n=!(c.length>1&&void 0!==c[1])||c[1],a=this.fullDate.time.split(":"),r=new Date(this.fullDate.date),r.setHours(a[0]),r.setMinutes(a[1]),i=this.errandObj.journey.return,this.errandObj.journey.return=r,this.getChanges(this.startErrandObject,this.errandObj)){t.next=14;break}return this.errandObj.journey.return=i,this.$emit("nextStage",this.errandObj,e,n),t.abrupt("return");case 14:this.errandObj.journey.return=i;case 15:return this.loaded=!1,t.next=18,o["a"].updateTowingErrandReturn({errandId:this.errandId,kilometers:this.errandObj.kilometers.return,date:r,surcharge:this.errandObj.surcharge,description:this.errandObj.description}).then((function(t){if(200!==t.status)return console.log(t.data.message),l.error=t.data.message;l.loaded=!0,l.$emit("nextStage",t.data,e,n)})).catch((function(t){if(console.log(t),200!==t.status)return console.log(t.data.message),l.error=t.data.message}));case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),formatDate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;e.setDate(e.getDate()+t);var n=""+(e.getMonth()+1),a=""+e.getDate(),r=e.getFullYear();return n.length<2&&(n="0".concat(n)),a.length<2&&(a="0".concat(a)),[r,n,a].join("-")},formatTime:function(){var t=new Date;t.setDate(t.getDate());var e="",n=t.getHours(),a=t.getMinutes();return e+=n<10?"0".concat(n,":"):"".concat(n,":"),e+=a<10?"0".concat(a):a,e}}},rt=at,it=Object(v["a"])(rt,X,tt,!1,null,null,null),st=it.exports;function ot(t,e,n,a,r,i,s){try{var o=t[i](s),l=o.value}catch(c){return void n(c)}o.done?e(l):Promise.resolve(l).then(a,r)}function lt(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function s(t){ot(i,a,r,s,o,"next",t)}function o(t){ot(i,a,r,s,o,"throw",t)}s(void 0)}))}}var ct={components:{Stage1:g,Stage2:B,Stage3:Q,Stage4:st},data:function(){return{errandId:this.$route.params.towingErrandId,stage:-1,error:null,loaded:!1,errand:null,show:!1,endAnim:!0}},beforeRouteEnter:function(){var t=lt(s.a.mark((function t(e,n,a){var r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.params.towingErrandId){t.next=2;break}return t.abrupt("return",a((function(t){t.loaded=!0,t.stage=0})));case 2:return t.next=4,o["a"].getErrand(e.params.towingErrandId);case 4:if(r=t.sent,200===r.status){t.next=7;break}return t.abrupt("return",a({name:"insertTowingErrand"}));case 7:a((function(t){t.errand=r.data,t.stage=1,t.loaded=!0}));case 8:case"end":return t.stop()}}),t)})));function e(e,n,a){return t.apply(this,arguments)}return e}(),mounted:function(){var t=this;alert("check consolelog"),console.log(this.$parent),setTimeout((function(){t.show=!0}),500),this.errandId?this.stage=1:this.stage=0},methods:{finishErrand:function(){var t=lt(s.a.mark((function t(e){var n;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].updateStatus({errandId:this.errandId,status:e});case 2:if(n=t.sent,200===n.status){t.next=5;break}return t.abrupt("return",this.error=n.data.message);case 5:this.$router.push({name:"errand",params:{towingErrandId:this.errandId}});case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),navStages:function(){var t=lt(s.a.mark((function t(e){var n=this;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e!==this.stage&&this.$refs["stage".concat(this.stage+1)]){t.next=2;break}return t.abrupt("return");case 2:console.log(this.stage+1),this.$refs["stage".concat(this.stage+1)].nextStage(!1).then((function(){n.stage=e}));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),nextStage:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t&&(this.errand=t,this.errandId!==t._id&&(this.errandId=t._id)),0===this.stage&&this.endAnimation(),e&&n?this.stage++:e&&!n&&this.stage--},verifyInput:function(){return this.errandNumber&&""!==this.errandNumber?this.loaded=!1:this.loaded=!0},takePhotoF:function(t){this.photos.push(t)},insertTowingErrand:function(){var t=lt(s.a.mark((function t(){var e;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].insertTowingErrand({errandNumber:this.errandNumber,photos:this.photos});case 2:if(e=t.sent,this.loaded=!0,200===e.status){t.next=6;break}return t.abrupt("return",this.error=e.data.message);case 6:this.$router.push({name:"errand",params:{towingErrandId:e.data}});case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),endAnimation:function(){var t=this;this.endAnim=!1,setTimeout((function(){t.endAnim=!0}),1e3)}}},ut=ct,dt=(n("a6f9"),Object(v["a"])(ut,a,r,!1,null,"526f108c",null));e["default"]=dt.exports},e902:function(t,e,n){"use strict";var a=n("652c"),r=n.n(a);r.a},ec51:function(t,e,n){},efbe:function(t,e,n){},f0ff:function(t,e,n){"use strict";var a=n("a217"),r=n.n(a);r.a},f322:function(t,e,n){"use strict";var a=n("0529"),r=n.n(a);r.a}}]);